<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thanh niên số Móng Cái 1</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Inter Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Leaflet CSS for Map -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    
    <style>
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
        }
        
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .line-clamp-3 {
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #0056B3;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #004494;
        }
        
        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
        }
        
        /* Loading animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.6s ease-out;
        }
        
        /* Leaflet Map Styles */
        .leaflet-container {
            border-radius: 8px;
            z-index: 1;
        }
        
        /* Search Autocomplete Styles */
        .autocomplete-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 0 0 8px 8px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
        }
        
        .autocomplete-item {
            padding: 10px 12px;
            cursor: pointer;
            border-bottom: 1px solid #f3f4f6;
            transition: background-color 0.15s;
        }
        
        .autocomplete-item:hover {
            background-color: #eff6ff;
        }
        
        .autocomplete-item:last-child {
            border-bottom: none;
        }
        
        /* Custom marker pulse animation */
        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.7; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .location-pin {
            animation: pulse 1.5s ease-in-out infinite;
        }
    </style>
    
    <!-- Tailwind CSS Configuration -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'youth-blue': '#0056B3',
                        'flag-red': '#DA251D',
                        'star-yellow': '#FFFF00',
                        'text-dark': '#1A1A1A'
                    },
                    fontFamily: {
                        'sans': ['Inter', 'system-ui', '-apple-system', 'sans-serif'],
                    }
                }
            }
        }
    </script>
</head>
<body>
    <div id="root"></div>
    
    <!-- Leaflet JS for Map -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    
    <!-- React and ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX transformation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Your React Component -->
    <script type="text/babel">
        // API Base URL
        const API_BASE_URL = '/api';

        // Simple SVG Icon Components for React
        const Icon = ({ children, className = "" }) => (
            <svg 
                className={className} 
                fill="none" 
                stroke="currentColor" 
                viewBox="0 0 24 24" 
                strokeWidth="2" 
                strokeLinecap="round" 
                strokeLinejoin="round"
            >
                {children}
            </svg>
        );

        const Search = ({ className }) => (
            <Icon className={className}>
                <circle cx="11" cy="11" r="8"></circle>
                <path d="m21 21-4.35-4.35"></path>
            </Icon>
        );

        const MapPin = ({ className }) => (
            <Icon className={className}>
                <path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"></path>
                <circle cx="12" cy="10" r="3"></circle>
            </Icon>
        );

        const Calendar = ({ className }) => (
            <Icon className={className}>
                <rect width="18" height="18" x="3" y="4" rx="2" ry="2"></rect>
                <line x1="16" x2="16" y1="2" y2="6"></line>
                <line x1="8" x2="8" y1="2" y2="6"></line>
                <line x1="3" x2="21" y1="10" y2="10"></line>
            </Icon>
        );

        const Building2 = ({ className }) => (
            <Icon className={className}>
                <path d="M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z"></path>
                <path d="M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2"></path>
                <path d="M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2"></path>
                <path d="M10 6h4"></path>
                <path d="M10 10h4"></path>
                <path d="M10 14h4"></path>
                <path d="M10 18h4"></path>
            </Icon>
        );

        const Heart = ({ className }) => (
            <Icon className={className}>
                <path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"></path>
            </Icon>
        );

        const GraduationCap = ({ className }) => (
            <Icon className={className}>
                <path d="M22 10v6M2 10l10-5 10 5-10 5z"></path>
                <path d="M6 12v5c0 2 2 3 6 3s6-1 6-3v-5"></path>
            </Icon>
        );

        const ShoppingBag = ({ className }) => (
            <Icon className={className}>
                <path d="M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z"></path>
                <path d="M3 6h18"></path>
                <path d="M16 10a4 4 0 0 1-8 0"></path>
            </Icon>
        );

        const Phone = ({ className }) => (
            <Icon className={className}>
                <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
            </Icon>
        );

        const Mail = ({ className }) => (
            <Icon className={className}>
                <rect width="20" height="16" x="2" y="4" rx="2"></rect>
                <path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"></path>
            </Icon>
        );

        const ExternalLink = ({ className }) => (
            <Icon className={className}>
                <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                <polyline points="15 3 21 3 21 9"></polyline>
                <line x1="10" x2="21" y1="14" y2="3"></line>
            </Icon>
        );

        const Plus = ({ className }) => (
            <Icon className={className}>
                <path d="M5 12h14"></path>
                <path d="M12 5v14"></path>
            </Icon>
        );

        const X = ({ className }) => (
            <Icon className={className}>
                <path d="M18 6 6 18"></path>
                <path d="m6 6 12 12"></path>
            </Icon>
        );

        const Star = ({ className }) => (
            <Icon className={className}>
                <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
            </Icon>
        );

        const Eye = ({ className }) => (
            <Icon className={className}>
                <path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"></path>
                <circle cx="12" cy="12" r="3"></circle>
            </Icon>
        );

        const Crosshair = ({ className }) => (
            <Icon className={className}>
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="22" x2="18" y1="12" y2="12"></line>
                <line x1="6" x2="2" y1="12" y2="12"></line>
                <line x1="12" x2="12" y1="6" y2="2"></line>
                <line x1="12" x2="12" y1="22" y2="18"></line>
            </Icon>
        );

        const Navigation2 = ({ className }) => (
            <Icon className={className}>
                <polygon points="12 2 19 21 12 17 5 21 12 2"></polygon>
            </Icon>
        );

        const Loader = ({ className }) => (
            <Icon className={className}>
                <line x1="12" x2="12" y1="2" y2="6"></line>
                <line x1="12" x2="12" y1="18" y2="22"></line>
                <line x1="4.93" x2="7.76" y1="4.93" y2="7.76"></line>
                <line x1="16.24" x2="19.07" y1="16.24" y2="19.07"></line>
                <line x1="2" x2="6" y1="12" y2="12"></line>
                <line x1="18" x2="22" y1="12" y2="12"></line>
                <line x1="4.93" x2="7.76" y1="19.07" y2="16.24"></line>
                <line x1="16.24" x2="19.07" y1="7.76" y2="4.93"></line>
            </Icon>
        );

        // ============================================
        // LOCATION PICKER COMPONENT WITH MAP
        // ============================================
        const LocationPickerMap = ({ coordinates, setCoordinates, onAddressFound }) => {
            const mapRef = React.useRef(null);
            const markerRef = React.useRef(null);
            const mapInstanceRef = React.useRef(null);

            // Móng Cái default center
            const defaultCenter = [21.5285, 107.9650];
            const defaultZoom = 15;

            React.useEffect(() => {
                // Initialize map only once
                if (!mapInstanceRef.current && mapRef.current) {
                    const map = L.map(mapRef.current).setView(
                        coordinates.lat && coordinates.lng 
                            ? [coordinates.lat, coordinates.lng] 
                            : defaultCenter, 
                        defaultZoom
                    );

                    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                        attribution: '© OpenStreetMap contributors'
                    }).addTo(map);

                    // Custom marker icon
                    const customIcon = L.divIcon({
                        className: 'custom-marker',
                        html: `<div style="
                            background: #DA251D;
                            width: 24px;
                            height: 24px;
                            border-radius: 50% 50% 50% 0;
                            transform: rotate(-45deg);
                            border: 3px solid white;
                            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
                        "></div>`,
                        iconSize: [24, 24],
                        iconAnchor: [12, 24]
                    });

                    // Add initial marker if coordinates exist
                    if (coordinates.lat && coordinates.lng) {
                        markerRef.current = L.marker([coordinates.lat, coordinates.lng], { icon: customIcon }).addTo(map);
                    }

                    // Click event to place marker
                    map.on('click', async (e) => {
                        const { lat, lng } = e.latlng;
                        
                        // Update or create marker
                        if (markerRef.current) {
                            markerRef.current.setLatLng([lat, lng]);
                        } else {
                            markerRef.current = L.marker([lat, lng], { icon: customIcon }).addTo(map);
                        }

                        setCoordinates({ lat: lat.toFixed(8), lng: lng.toFixed(8) });

                        // Reverse geocoding to get address
                        try {
                            const response = await fetch(
                                `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}&zoom=18&addressdetails=1`,
                                { headers: { 'Accept-Language': 'vi' } }
                            );
                            const data = await response.json();
                            if (data.display_name && onAddressFound) {
                                onAddressFound(data.display_name);
                            }
                        } catch (err) {
                            console.error('Reverse geocoding error:', err);
                        }
                    });

                    mapInstanceRef.current = map;
                }

                return () => {
                    // Cleanup on unmount
                    if (mapInstanceRef.current) {
                        mapInstanceRef.current.remove();
                        mapInstanceRef.current = null;
                    }
                };
            }, []);

            // Update marker when coordinates change externally
            React.useEffect(() => {
                if (mapInstanceRef.current && coordinates.lat && coordinates.lng) {
                    const customIcon = L.divIcon({
                        className: 'custom-marker',
                        html: `<div style="
                            background: #DA251D;
                            width: 24px;
                            height: 24px;
                            border-radius: 50% 50% 50% 0;
                            transform: rotate(-45deg);
                            border: 3px solid white;
                            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
                        "></div>`,
                        iconSize: [24, 24],
                        iconAnchor: [12, 24]
                    });

                    if (markerRef.current) {
                        markerRef.current.setLatLng([parseFloat(coordinates.lat), parseFloat(coordinates.lng)]);
                    } else {
                        markerRef.current = L.marker(
                            [parseFloat(coordinates.lat), parseFloat(coordinates.lng)], 
                            { icon: customIcon }
                        ).addTo(mapInstanceRef.current);
                    }
                    
                    mapInstanceRef.current.setView([parseFloat(coordinates.lat), parseFloat(coordinates.lng)], defaultZoom);
                }
            }, [coordinates.lat, coordinates.lng]);

            return (
                <div 
                    ref={mapRef} 
                    style={{ height: '300px', width: '100%', borderRadius: '8px' }}
                    className="border border-gray-300"
                />
            );
        };

        // ============================================
        // ADDRESS SEARCH AUTOCOMPLETE COMPONENT
        // ============================================
        const AddressSearch = ({ onSelectAddress, onCoordinatesFound }) => {
            const [query, setQuery] = React.useState('');
            const [results, setResults] = React.useState([]);
            const [isSearching, setIsSearching] = React.useState(false);
            const [showDropdown, setShowDropdown] = React.useState(false);
            const searchTimeout = React.useRef(null);

            const searchAddress = async (searchQuery) => {
                if (!searchQuery || searchQuery.length < 3) {
                    setResults([]);
                    return;
                }

                setIsSearching(true);
                try {
                    // Add Móng Cái to search for better local results
                    const searchWithContext = `${searchQuery}, Móng Cái, Quảng Ninh, Vietnam`;
                    const response = await fetch(
                        `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(searchWithContext)}&limit=5&addressdetails=1`,
                        { headers: { 'Accept-Language': 'vi' } }
                    );
                    const data = await response.json();
                    setResults(data);
                    setShowDropdown(data.length > 0);
                } catch (err) {
                    console.error('Search error:', err);
                    setResults([]);
                } finally {
                    setIsSearching(false);
                }
            };

            const handleInputChange = (e) => {
                const value = e.target.value;
                setQuery(value);

                // Debounce search
                if (searchTimeout.current) {
                    clearTimeout(searchTimeout.current);
                }
                searchTimeout.current = setTimeout(() => {
                    searchAddress(value);
                }, 500);
            };

            const handleSelectResult = (result) => {
                setQuery(result.display_name);
                setShowDropdown(false);
                
                if (onSelectAddress) {
                    onSelectAddress(result.display_name);
                }
                if (onCoordinatesFound) {
                    onCoordinatesFound({
                        lat: parseFloat(result.lat).toFixed(8),
                        lng: parseFloat(result.lon).toFixed(8)
                    });
                }
            };

            return (
                <div className="relative">
                    <div className="relative">
                        <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5" />
                        <input
                            type="text"
                            value={query}
                            onChange={handleInputChange}
                            onFocus={() => results.length > 0 && setShowDropdown(true)}
                            placeholder="Tìm kiếm địa chỉ (VD: Chợ Móng Cái, UBND phường...)"
                            className="w-full pl-10 pr-10 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0056B3]"
                        />
                        {isSearching && (
                            <div className="absolute right-3 top-1/2 transform -translate-y-1/2">
                                <Loader className="h-5 w-5 text-gray-400 animate-spin" />
                            </div>
                        )}
                    </div>

                    {showDropdown && results.length > 0 && (
                        <div className="autocomplete-dropdown">
                            {results.map((result, index) => (
                                <div
                                    key={index}
                                    className="autocomplete-item"
                                    onClick={() => handleSelectResult(result)}
                                >
                                    <div className="flex items-start">
                                        <MapPin className="h-4 w-4 text-[#DA251D] mr-2 mt-1 flex-shrink-0" />
                                        <div>
                                            <p className="text-sm font-medium text-gray-800 line-clamp-2">
                                                {result.display_name}
                                            </p>
                                            {result.type && (
                                                <p className="text-xs text-gray-500 mt-1">
                                                    {result.type}
                                                </p>
                                            )}
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    )}
                </div>
            );
        };

        // ============================================
        // GET CURRENT LOCATION BUTTON
        // ============================================
        const GetCurrentLocationButton = ({ onLocationFound, disabled }) => {
            const [isLoading, setIsLoading] = React.useState(false);
            const [error, setError] = React.useState(null);

            const getCurrentLocation = () => {
                if (!navigator.geolocation) {
                    setError('Trình duyệt không hỗ trợ định vị GPS');
                    return;
                }

                setIsLoading(true);
                setError(null);

                navigator.geolocation.getCurrentPosition(
                    async (position) => {
                        const lat = position.coords.latitude;
                        const lng = position.coords.longitude;
                        
                        onLocationFound({
                            lat: lat.toFixed(8),
                            lng: lng.toFixed(8)
                        });

                        // Get address from coordinates
                        try {
                            const response = await fetch(
                                `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}&zoom=18&addressdetails=1`,
                                { headers: { 'Accept-Language': 'vi' } }
                            );
                            const data = await response.json();
                            if (data.display_name && onLocationFound) {
                                onLocationFound({
                                    lat: lat.toFixed(8),
                                    lng: lng.toFixed(8),
                                    address: data.display_name
                                });
                            }
                        } catch (err) {
                            console.error('Reverse geocoding error:', err);
                        }

                        setIsLoading(false);
                    },
                    (err) => {
                        setIsLoading(false);
                        switch(err.code) {
                            case err.PERMISSION_DENIED:
                                setError('Bạn đã từ chối quyền truy cập vị trí');
                                break;
                            case err.POSITION_UNAVAILABLE:
                                setError('Không thể xác định vị trí');
                                break;
                            case err.TIMEOUT:
                                setError('Hết thời gian chờ định vị');
                                break;
                            default:
                                setError('Lỗi không xác định');
                        }
                    },
                    { enableHighAccuracy: true, timeout: 10000, maximumAge: 0 }
                );
            };

            return (
                <div>
                    <button
                        type="button"
                        onClick={getCurrentLocation}
                        disabled={isLoading || disabled}
                        className={`flex items-center justify-center w-full py-2.5 px-4 rounded-lg border-2 border-dashed transition duration-200 ${
                            isLoading || disabled
                                ? 'border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed'
                                : 'border-[#0056B3] bg-blue-50 text-[#0056B3] hover:bg-blue-100'
                        }`}
                    >
                        {isLoading ? (
                            <>
                                <Loader className="h-5 w-5 mr-2 animate-spin" />
                                Đang xác định vị trí...
                            </>
                        ) : (
                            <>
                                <Crosshair className="h-5 w-5 mr-2" />
                                Lấy vị trí hiện tại của tôi
                            </>
                        )}
                    </button>
                    {error && (
                        <p className="text-red-500 text-sm mt-2 flex items-center">
                            <span className="mr-1">⚠️</span> {error}
                        </p>
                    )}
                </div>
            );
        };

        const MongCaiPortal = () => {
            const [activeCategory, setActiveCategory] = React.useState('all');
            const [searchTerm, setSearchTerm] = React.useState('');
            const [isMobileMenuOpen, setIsMobileMenuOpen] = React.useState(false);
            
            // State for data from database
            const [locations, setLocations] = React.useState([]);
            const [newsItems, setNewsItems] = React.useState([]);
            const [categories, setCategories] = React.useState([]);
            const [loading, setLoading] = React.useState(true);
            const [error, setError] = React.useState(null);
            
            // State for detail modals
            const [selectedPost, setSelectedPost] = React.useState(null);
            const [selectedLocation, setSelectedLocation] = React.useState(null);
            const [isPostDetailOpen, setIsPostDetailOpen] = React.useState(false);
            const [isLocationDetailOpen, setIsLocationDetailOpen] = React.useState(false);
            const [isLoadingDetail, setIsLoadingDetail] = React.useState(false);

            // Icon mapping for categories
            const iconMap = {
                'Building2': Building2,
                'Heart': Heart,
                'GraduationCap': GraduationCap,
                'ShoppingBag': ShoppingBag
            };

            // Fetch data from API
            const fetchData = async () => {
                try {
                    setLoading(true);
                    setError(null);

                    // Fetch locations, posts and categories in parallel
                    const [locationsRes, postsRes, categoriesRes] = await Promise.all([
                        fetch(`${API_BASE_URL}/locations/simple`),
                        fetch(`${API_BASE_URL}/posts?size=6&sortBy=publishedAt&sortDir=desc`),
                        fetch(`${API_BASE_URL}/categories/locations`)
                    ]);

                    if (!locationsRes.ok || !postsRes.ok || !categoriesRes.ok) {
                        throw new Error('Không thể tải dữ liệu từ server');
                    }

                    const locationsData = await locationsRes.json();
                    const postsData = await postsRes.json();
                    const categoriesData = await categoriesRes.json();

                    setLocations(Array.isArray(locationsData) ? locationsData : []);
                    setNewsItems(postsData.content || []);
                    
                    // Build categories with icons
                    const formattedCategories = [
                        { id: 'all', name: 'Tất cả', icon: Building2 }
                    ];
                    
                    if (Array.isArray(categoriesData)) {
                        categoriesData.forEach(cat => {
                            formattedCategories.push({
                                id: cat.id,
                                name: cat.name,
                                icon: iconMap[cat.icon] || Building2
                            });
                        });
                    }
                    
                    setCategories(formattedCategories);

                } catch (err) {
                    console.error('Error fetching data:', err);
                    setError(err.message);
                } finally {
                    setLoading(false);
                }
            };

            // Fetch data on component mount
            React.useEffect(() => {
                fetchData();
            }, []);

            // Filter locations based on category and search
            const filteredLocations = React.useMemo(() => {
                return locations.filter(location => {
                    const matchesCategory = activeCategory === 'all' || 
                        (location.category && location.category.id.toString() === activeCategory.toString());
                    const matchesSearch = location.name?.toLowerCase().includes(searchTerm.toLowerCase()) ||
                                        location.address?.toLowerCase().includes(searchTerm.toLowerCase());
                return matchesCategory && matchesSearch;
            });
            }, [locations, activeCategory, searchTerm]);

            // Format date
            const formatDate = (dateString) => {
                if (!dateString) return '';
                const date = new Date(dateString);
                return date.toLocaleDateString('vi-VN', {
                    day: '2-digit',
                    month: '2-digit',
                    year: 'numeric'
                });
            };

            // View post detail
            const handleViewPost = async (postId) => {
                try {
                    setIsLoadingDetail(true);
                    const response = await fetch(`${API_BASE_URL}/posts/${postId}`);
                    if (!response.ok) throw new Error('Không thể tải bài viết');
                    const data = await response.json();
                    setSelectedPost(data);
                    setIsPostDetailOpen(true);
                } catch (err) {
                    console.error('Error loading post:', err);
                    alert('Không thể tải bài viết. Vui lòng thử lại.');
                } finally {
                    setIsLoadingDetail(false);
                }
            };

            // View location detail
            const handleViewLocation = async (locationId) => {
                try {
                    setIsLoadingDetail(true);
                    const response = await fetch(`${API_BASE_URL}/locations/${locationId}`);
                    if (!response.ok) throw new Error('Không thể tải địa điểm');
                    const data = await response.json();
                    setSelectedLocation(data);
                    setIsLocationDetailOpen(true);
                } catch (err) {
                    console.error('Error loading location:', err);
                    alert('Không thể tải thông tin địa điểm. Vui lòng thử lại.');
                } finally {
                    setIsLoadingDetail(false);
                }
            };

            // Close mobile menu when clicking outside
            React.useEffect(() => {
                const handleClickOutside = () => {
                    setIsMobileMenuOpen(false);
                };
                document.addEventListener('click', handleClickOutside);
                return () => document.removeEventListener('click', handleClickOutside);
            }, []);

            // Loading state
            if (loading) {
                return (
                    <div className="min-h-screen bg-white flex items-center justify-center">
                        <div className="text-center">
                            <div className="animate-spin rounded-full h-16 w-16 border-b-4 border-[#0056B3] mx-auto mb-4"></div>
                            <p className="text-gray-600 text-lg">Đang tải dữ liệu...</p>
                        </div>
                    </div>
                );
            }

            // Error state
            if (error) {
                return (
                    <div className="min-h-screen bg-white flex items-center justify-center">
                        <div className="text-center">
                            <div className="text-red-500 text-6xl mb-4">⚠️</div>
                            <h2 className="text-2xl font-bold text-gray-800 mb-2">Lỗi tải dữ liệu</h2>
                            <p className="text-gray-600 mb-4">{error}</p>
                            <button 
                                onClick={fetchData}
                                className="bg-[#0056B3] hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition duration-200"
                            >
                                Thử lại
                            </button>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-white">
                    {/* Navigation */}
                    <nav className="sticky top-0 z-50 bg-[#0056B3] shadow-lg">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                            <div className="flex justify-between items-center h-16">
                                <div className="flex items-center">
                                    <Star className="h-8 w-8 text-[#FFFF00] mr-3" />
                                    <span className="text-white text-xl font-bold">Móng Cái 1</span>
                                </div>
                                
                                {/* Desktop Navigation */}
                                <div className="hidden md:block">
                                    <div className="ml-10 flex items-baseline space-x-4">
                                        <a href="#home" className="text-white hover:bg-blue-700 px-3 py-2 rounded-md text-sm font-medium transition duration-200">
                                            Trang chủ
                                        </a>
                                        <a href="#locations" className="text-white hover:bg-blue-700 px-3 py-2 rounded-md text-sm font-medium transition duration-200">
                                            Địa điểm
                                        </a>
                                        <a href="#news" className="text-white hover:bg-blue-700 px-3 py-2 rounded-md text-sm font-medium transition duration-200">
                                            Tin tức
                                        </a>
                                        <a href="/admin.html" className="text-yellow-300 hover:bg-blue-700 px-3 py-2 rounded-md text-sm font-medium transition duration-200 flex items-center gap-1">
                                            <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                                            </svg>
                                            Quản trị
                                        </a>
                                    </div>
                                </div>

                                {/* Mobile menu button */}
                                <div className="md:hidden">
                                    <button
                                        onClick={(e) => {
                                            e.stopPropagation();
                                            setIsMobileMenuOpen(!isMobileMenuOpen);
                                        }}
                                        className="text-white hover:text-gray-300 focus:outline-none focus:text-gray-300"
                                    >
                                        <svg className="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 6h16M4 12h16M4 18h16" />
                                        </svg>
                                    </button>
                                </div>
                            </div>
                        </div>

                        {/* Mobile Navigation Menu */}
                        {isMobileMenuOpen && (
                            <div className="md:hidden bg-[#0056B3] border-t border-blue-600">
                                <div className="px-2 pt-2 pb-3 space-y-1">
                                    <a href="#home" className="text-white block px-3 py-2 rounded-md text-base font-medium hover:bg-blue-700">
                                        Trang chủ
                                    </a>
                                    <a href="#locations" className="text-white block px-3 py-2 rounded-md text-base font-medium hover:bg-blue-700">
                                        Địa điểm
                                    </a>
                                    <a href="#news" className="text-white block px-3 py-2 rounded-md text-base font-medium hover:bg-blue-700">
                                        Tin tức
                                    </a>
                                    <a href="/admin.html" className="text-yellow-300 block px-3 py-2 rounded-md text-base font-medium hover:bg-blue-700 flex items-center gap-2">
                                        <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                                        </svg>
                                        Quản trị
                                    </a>
                                </div>
                            </div>
                        )}
                    </nav>

                    {/* Hero Section */}
                    <section id="home" className="bg-gradient-to-r from-blue-50 to-blue-100 py-16 fade-in">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
                            <h1 className="text-4xl md:text-5xl font-bold text-[#1A1A1A] mb-4">
                                Thanh niên số Móng Cái 1
                            </h1>
                            <p className="text-xl text-gray-600 mb-8 max-w-3xl mx-auto">
                                Nơi kết nối thông tin và dịch vụ cho cộng đồng khu vực Móng Cái 1
                            </p>
                            
                            {/* Search Bar */}
                            <div className="max-w-2xl mx-auto relative">
                                <div className="flex">
                                    <div className="relative flex-1">
                                        <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5" />
                                        <input
                                            type="text"
                                            placeholder="Tìm kiếm địa điểm, tin tức..."
                                            className="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-l-lg focus:outline-none focus:ring-2 focus:ring-[#0056B3] focus:border-transparent"
                                            value={searchTerm}
                                            onChange={(e) => setSearchTerm(e.target.value)}
                                        />
                                    </div>
                                    <button className="bg-[#0056B3] hover:bg-blue-700 text-white px-6 py-3 rounded-r-lg transition duration-200">
                                        Tìm kiếm
                                    </button>
                                </div>
                            </div>
                        </div>
                    </section>

                    {/* Location Directory */}
                    <section id="locations" className="py-16 bg-gray-50">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                            <div className="text-center mb-12">
                                <h2 className="text-3xl font-bold text-[#1A1A1A] mb-2">
                                    Danh bạ địa điểm
                                </h2>
                                <p className="text-lg text-gray-600">
                                    Tìm kiếm các địa điểm quan trọng trong khu vực
                                </p>
                            </div>

                            {/* Category Filter */}
                            <div className="flex flex-wrap justify-center mb-8 gap-2">
                                {categories.map((category) => {
                                    const IconComponent = category.icon || Building2;
                                    return (
                                        <button
                                            key={category.id}
                                            onClick={() => setActiveCategory(category.id)}
                                            className={`flex items-center px-4 py-2 rounded-full text-sm font-medium transition duration-200 ${
                                                activeCategory.toString() === category.id.toString()
                                                    ? 'bg-[#0056B3] text-white'
                                                    : 'bg-white text-gray-700 hover:bg-gray-100 border border-gray-300'
                                            }`}
                                        >
                                            <IconComponent className="h-4 w-4 mr-2" />
                                            {category.name}
                                        </button>
                                    );
                                })}
                            </div>

                            {/* Location Cards */}
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                                {filteredLocations.map((location) => {
                                    const IconComponent = location.category?.icon ? 
                                        (iconMap[location.category.icon] || Building2) : Building2;
                                    return (
                                        <div
                                            key={location.id}
                                            className="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition duration-200"
                                        >
                                            <div 
                                                onClick={(e) => {
                                                    e.stopPropagation();
                                                    handleViewLocation(location.id);
                                                }}
                                                className="h-48 bg-gray-200 flex items-center justify-center relative group overflow-hidden"
                                            >
                                                {location.imageUrl ? (
                                                    <img 
                                                        src={location.imageUrl} 
                                                        alt={location.name}
                                                        className="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
                                                    />
                                                ) : (
                                                    <IconComponent className="h-16 w-16 text-gray-400 group-hover:text-[#0056B3] transition-colors" />
                                                )}
                                                {location.category && (
                                                    <div className="absolute top-2 right-2 bg-white bg-opacity-90 px-2 py-1 rounded text-xs font-medium text-gray-700">
                                                        {location.category.name}
                                                    </div>
                                                )}
                                                <div className="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition-all flex items-center justify-center">
                                                    <span className="opacity-0 group-hover:opacity-100 bg-white px-3 py-1 rounded-full text-sm font-medium text-[#0056B3] transition-opacity shadow-md">
                                                        Xem chi tiết
                                                    </span>
                                                </div>
                                            </div>
                                            <div className="p-4">
                                                <h3 
                                                    onClick={(e) => {
                                                        e.stopPropagation();
                                                        handleViewLocation(location.id);
                                                    }}
                                                    className="font-semibold text-[#1A1A1A] mb-2 line-clamp-2 hover:text-[#0056B3] cursor-pointer transition-colors"
                                                >
                                                    {location.name}
                                                </h3>
                                                <p className="text-sm text-gray-600 mb-2 flex items-start">
                                                <MapPin className="h-4 w-4 text-[#DA251D] mr-1 mt-0.5 flex-shrink-0" />
                                                    <span className="line-clamp-2">{location.address}</span>
                                                </p>
                                                {location.phone && (
                                                    <p className="text-sm text-gray-600 mb-3 flex items-center">
                                                        <Phone className="h-4 w-4 text-[#0056B3] mr-1" />
                                                        {location.phone}
                                                    </p>
                                                )}
                                                <div className="flex gap-2">
                                                    <button 
                                                        onClick={(e) => {
                                                            e.stopPropagation();
                                                            handleViewLocation(location.id);
                                                        }}
                                                        className="flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 py-2 px-3 rounded-md text-sm font-medium transition duration-200 flex items-center justify-center"
                                                    >
                                                        <Eye className="h-4 w-4 mr-1" />
                                                        Chi tiết
                                                    </button>
                                                    <button 
                                                        onClick={(e) => {
                                                            e.stopPropagation();
                                                            if (location.latitude && location.longitude) {
                                                                window.open(`https://www.google.com/maps/dir/?api=1&destination=${location.latitude},${location.longitude}`, '_blank');
                                                            } else {
                                                                window.open(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(location.address)}`, '_blank');
                                                            }
                                                        }}
                                                        className="flex-1 bg-[#0056B3] hover:bg-blue-700 text-white py-2 px-3 rounded-md text-sm font-medium transition duration-200 flex items-center justify-center"
                                                    >
                                                        <MapPin className="h-4 w-4 mr-1" />
                                                        Chỉ đường
                                                    </button>
                                                </div>
                                    </div>
                                        </div>
                                    );
                                })}
                            </div>

                            {filteredLocations.length === 0 && (
                                <div className="text-center py-12">
                                    <p className="text-gray-500 text-lg">Không tìm thấy địa điểm phù hợp</p>
                                </div>
                            )}
                        </div>
                    </section>

                    {/* News Section */}
                    <section id="news" className="py-16 bg-white">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                            <div className="text-center mb-12">
                                <h2 className="text-3xl font-bold text-[#1A1A1A] mb-4">
                                    Tin tức & Thông báo
                                </h2>
                                <p className="text-lg text-gray-600">
                                    Cập nhật thông tin mới nhất từ khu vực
                                </p>
                            </div>

                            {/* News Cards */}
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                                {newsItems.map((news) => (
                                    <article
                                        key={news.id}
                                        onClick={() => handleViewPost(news.id)}
                                        className="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition duration-200 cursor-pointer transform hover:-translate-y-1"
                                    >
                                        <div className="h-48 bg-gray-200 flex items-center justify-center relative overflow-hidden">
                                            {news.thumbnailUrl ? (
                                                <img 
                                                    src={news.thumbnailUrl} 
                                                    alt={news.title}
                                                    className="w-full h-full object-cover hover:scale-105 transition-transform duration-300"
                                                />
                                            ) : (
                                                <Calendar className="h-16 w-16 text-gray-400" />
                                            )}
                                            {news.isUrgent && (
                                                <div className="absolute top-2 left-2 bg-[#DA251D] text-white px-2 py-1 rounded text-xs font-bold">
                                                    KHẨN CẤP
                                                </div>
                                            )}
                                            {news.isFeatured && (
                                                <div className="absolute top-2 right-2 bg-[#FFFF00] text-[#1A1A1A] px-2 py-1 rounded text-xs font-bold">
                                                    NỔI BẬT
                                                </div>
                                            )}
                                        </div>
                                        <div className="p-6">
                                            <div className="flex items-center justify-between mb-2">
                                                <div className="flex items-center">
                                                <Calendar className="h-4 w-4 text-[#DA251D] mr-2" />
                                                <span className="text-sm font-medium text-[#DA251D]">
                                                        {formatDate(news.publishedAt)}
                                                </span>
                                                </div>
                                                <div className="flex items-center text-gray-500 text-sm">
                                                    <Eye className="h-4 w-4 mr-1" />
                                                    <span>{news.viewCount || 0}</span>
                                                </div>
                                            </div>
                                            <h3 className="font-bold text-[#1A1A1A] mb-3 text-lg line-clamp-2">
                                                {news.title}
                                            </h3>
                                            <p className="text-gray-600 text-sm line-clamp-3 mb-4">
                                                {news.summary || news.content?.replace(/<[^>]*>/g, '').substring(0, 150) + '...'}
                                            </p>
                                            <div className="flex items-center justify-between">
                                                <span className="text-xs text-gray-500">{news.author}</span>
                                                <button 
                                                    onClick={(e) => {
                                                        e.stopPropagation();
                                                        handleViewPost(news.id);
                                                    }}
                                                    className="text-[#0056B3] hover:text-blue-700 font-medium text-sm flex items-center"
                                                >
                                                Đọc thêm
                                                <ExternalLink className="h-4 w-4 ml-1" />
                                            </button>
                                            </div>
                                        </div>
                                    </article>
                                ))}
                            </div>

                            {newsItems.length === 0 && (
                                <div className="text-center py-12">
                                    <p className="text-gray-500 text-lg">Chưa có tin tức nào</p>
                                </div>
                            )}
                        </div>
                    </section>

                    {/* Post Detail Modal */}
                    {isPostDetailOpen && selectedPost && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                            <div className="bg-white rounded-lg max-w-3xl w-full max-h-[90vh] overflow-y-auto">
                                <div className="sticky top-0 bg-white border-b z-10">
                                    <div className="flex justify-between items-center p-6">
                                        <div className="flex items-center space-x-3">
                                            {selectedPost.isUrgent && (
                                                <span className="bg-[#DA251D] text-white px-2 py-1 rounded text-xs font-bold">
                                                    KHẨN CẤP
                                                </span>
                                            )}
                                            {selectedPost.isFeatured && (
                                                <span className="bg-[#FFFF00] text-[#1A1A1A] px-2 py-1 rounded text-xs font-bold">
                                                    NỔI BẬT
                                                </span>
                                            )}
                                        </div>
                                        <button
                                            onClick={() => {
                                                setIsPostDetailOpen(false);
                                                setSelectedPost(null);
                                            }}
                                            className="text-gray-400 hover:text-gray-600 p-1"
                                        >
                                            <X className="h-6 w-6" />
                                        </button>
                                    </div>
                                </div>
                                
                                <div className="p-6">
                                    {/* Post Header */}
                                    <h1 className="text-2xl md:text-3xl font-bold text-[#1A1A1A] mb-4">
                                        {selectedPost.title}
                                    </h1>
                                    
                                    {/* Meta Info */}
                                    <div className="flex flex-wrap items-center gap-4 mb-6 text-sm text-gray-600">
                                        <div className="flex items-center">
                                            <Calendar className="h-4 w-4 text-[#DA251D] mr-2" />
                                            <span>{formatDate(selectedPost.publishedAt)}</span>
                                        </div>
                                        <div className="flex items-center">
                                            <svg className="h-4 w-4 text-[#0056B3] mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                            </svg>
                                            <span>{selectedPost.author || 'Admin'}</span>
                                        </div>
                                        <div className="flex items-center">
                                            <Eye className="h-4 w-4 text-gray-400 mr-2" />
                                            <span>{selectedPost.viewCount || 0} lượt xem</span>
                                        </div>
                                        {selectedPost.category && (
                                            <div className="flex items-center">
                                                <span className="bg-blue-100 text-[#0056B3] px-2 py-1 rounded text-xs font-medium">
                                                    {selectedPost.category.name}
                                                </span>
                                            </div>
                                        )}
                                    </div>
                                    
                                    {/* Summary */}
                                    {selectedPost.summary && (
                                        <div className="bg-blue-50 border-l-4 border-[#0056B3] p-4 mb-6 rounded-r-lg">
                                            <p className="text-gray-700 italic">
                                                {selectedPost.summary}
                                            </p>
                                        </div>
                                    )}
                                    
                                    {/* Thumbnail */}
                                    {selectedPost.thumbnailUrl && (
                                        <div className="mb-6">
                                            <img 
                                                src={selectedPost.thumbnailUrl} 
                                                alt={selectedPost.title}
                                                className="w-full h-auto rounded-lg shadow-md"
                                            />
                                        </div>
                                    )}
                                    
                                    {/* Content */}
                                    <div 
                                        className="prose prose-lg max-w-none text-gray-700 leading-relaxed"
                                        style={{ whiteSpace: 'pre-wrap' }}
                                    >
                                        {selectedPost.content}
                                    </div>
                                    
                                    {/* Share Buttons */}
                                    <div className="mt-8 pt-6 border-t">
                                        <div className="flex items-center justify-between">
                                            <span className="text-sm text-gray-500">Chia sẻ bài viết:</span>
                                            <div className="flex gap-3">
                                                <button 
                                                    onClick={() => {
                                                        const url = window.location.href;
                                                        window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}&quote=${encodeURIComponent(selectedPost.title)}`, '_blank');
                                                    }}
                                                    className="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition"
                                                >
                                                    Facebook
                                                </button>
                                                <button 
                                                    onClick={() => {
                                                        navigator.clipboard.writeText(window.location.href);
                                                        alert('Đã sao chép liên kết!');
                                                    }}
                                                    className="bg-gray-200 hover:bg-gray-300 text-gray-700 px-4 py-2 rounded-lg text-sm font-medium transition"
                                                >
                                                    Sao chép link
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Location Detail Modal */}
                    {isLocationDetailOpen && selectedLocation && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                            <div className="bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                                <div className="sticky top-0 bg-white border-b z-10">
                                    <div className="flex justify-between items-center p-6">
                                        <div className="flex items-center">
                                            {selectedLocation.category && (
                                                <span className="bg-blue-100 text-[#0056B3] px-3 py-1 rounded-full text-sm font-medium">
                                                    {selectedLocation.category.name}
                                                </span>
                                            )}
                                        </div>
                                        <button
                                            onClick={() => {
                                                setIsLocationDetailOpen(false);
                                                setSelectedLocation(null);
                                            }}
                                            className="text-gray-400 hover:text-gray-600 p-1"
                                        >
                                            <X className="h-6 w-6" />
                                        </button>
                                    </div>
                                </div>
                                
                                <div className="p-6">
                                    {/* Location Name */}
                                    <h1 className="text-2xl font-bold text-[#1A1A1A] mb-4">
                                        {selectedLocation.name}
                                    </h1>
                                    
                                    {/* Address */}
                                    <div className="flex items-start mb-4">
                                        <MapPin className="h-5 w-5 text-[#DA251D] mr-3 mt-0.5 flex-shrink-0" />
                                        <p className="text-gray-700">{selectedLocation.address}</p>
                                    </div>
                                    
                                    {/* Description */}
                                    {selectedLocation.description && (
                                        <div className="bg-gray-50 p-4 rounded-lg mb-6">
                                            <p className="text-gray-700">{selectedLocation.description}</p>
                                        </div>
                                    )}
                                    
                                    {/* Contact Information */}
                                    <div className="space-y-3 mb-6">
                                        {selectedLocation.phone && (
                                            <div className="flex items-center">
                                                <Phone className="h-5 w-5 text-[#0056B3] mr-3" />
                                                <a href={`tel:${selectedLocation.phone}`} className="text-[#0056B3] hover:underline">
                                                    {selectedLocation.phone}
                                                </a>
                                            </div>
                                        )}
                                        
                                        {selectedLocation.email && (
                                            <div className="flex items-center">
                                                <Mail className="h-5 w-5 text-[#0056B3] mr-3" />
                                                <a href={`mailto:${selectedLocation.email}`} className="text-[#0056B3] hover:underline">
                                                    {selectedLocation.email}
                                                </a>
                                            </div>
                                        )}
                                        
                                        {selectedLocation.website && (
                                            <div className="flex items-center">
                                                <ExternalLink className="h-5 w-5 text-[#0056B3] mr-3" />
                                                <a href={selectedLocation.website} target="_blank" rel="noopener noreferrer" className="text-[#0056B3] hover:underline">
                                                    {selectedLocation.website}
                                                </a>
                                            </div>
                                        )}
                                        
                                        {selectedLocation.openingHours && (
                                            <div className="flex items-center">
                                                <svg className="h-5 w-5 text-green-600 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                                                </svg>
                                                <span className="text-gray-700">{selectedLocation.openingHours}</span>
                                            </div>
                                        )}
                                    </div>
                                    
                                    {/* Map Preview (if coordinates exist) */}
                                    {selectedLocation.latitude && selectedLocation.longitude && (
                                        <div className="mb-6">
                                            <h3 className="font-semibold text-gray-800 mb-3 flex items-center">
                                                <MapPin className="h-5 w-5 mr-2 text-[#DA251D]" />
                                                Vị trí trên bản đồ
                                            </h3>
                                            <div className="bg-gray-100 rounded-lg overflow-hidden">
                                                <iframe
                                                    width="100%"
                                                    height="250"
                                                    frameBorder="0"
                                                    style={{ border: 0 }}
                                                    src={`https://www.openstreetmap.org/export/embed.html?bbox=${parseFloat(selectedLocation.longitude) - 0.005},${parseFloat(selectedLocation.latitude) - 0.003},${parseFloat(selectedLocation.longitude) + 0.005},${parseFloat(selectedLocation.latitude) + 0.003}&layer=mapnik&marker=${selectedLocation.latitude},${selectedLocation.longitude}`}
                                                    allowFullScreen
                                                ></iframe>
                                            </div>
                                            <p className="text-xs text-gray-500 mt-2">
                                                📍 Tọa độ: {selectedLocation.latitude}, {selectedLocation.longitude}
                                            </p>
                                        </div>
                                    )}
                                    
                                    {/* Action Buttons */}
                                    <div className="flex flex-col sm:flex-row gap-3 pt-4 border-t">
                                        <button 
                                            onClick={() => {
                                                if (selectedLocation.latitude && selectedLocation.longitude) {
                                                    window.open(`https://www.google.com/maps/dir/?api=1&destination=${selectedLocation.latitude},${selectedLocation.longitude}`, '_blank');
                                                } else {
                                                    window.open(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(selectedLocation.address)}`, '_blank');
                                                }
                                            }}
                                            className="flex-1 bg-[#0056B3] hover:bg-blue-700 text-white py-3 px-4 rounded-lg font-medium transition duration-200 flex items-center justify-center"
                                        >
                                            <Navigation2 className="h-5 w-5 mr-2" />
                                            Chỉ đường với Google Maps
                                        </button>
                                        
                                        {selectedLocation.phone && (
                                            <a 
                                                href={`tel:${selectedLocation.phone}`}
                                                className="flex-1 bg-green-600 hover:bg-green-700 text-white py-3 px-4 rounded-lg font-medium transition duration-200 flex items-center justify-center"
                                            >
                                                <Phone className="h-5 w-5 mr-2" />
                                                Gọi ngay
                                            </a>
                                        )}
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Loading Overlay */}
                    {isLoadingDetail && (
                        <div className="fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50">
                            <div className="bg-white rounded-lg p-6 shadow-xl flex items-center">
                                <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-[#0056B3] mr-4"></div>
                                <span className="text-gray-700">Đang tải...</span>
                            </div>
                        </div>
                    )}

                    {/* Footer */}
                    <footer className="bg-gray-800 text-white py-12">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                            <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
                                <div>
                                    <div className="flex items-center mb-4">
                                        <Star className="h-8 w-8 text-[#FFFF00] mr-3" />
                                        <span className="text-xl font-bold">Móng Cái 1</span>
                                    </div>
                                    <p className="text-gray-300 text-sm leading-relaxed">
                                        Trang thông tin chính thức của Đoàn Thanh niên khu vực Móng Cái 1, 
                                        cung cấp thông tin dịch vụ và tin tức cho cộng đồng.
                                    </p>
                                </div>
                                
                                <div>
                                    <h4 className="font-bold mb-4">Thông tin liên hệ</h4>
                                    <div className="space-y-2 text-sm">
                                        <div className="flex items-center">
                                            <MapPin className="h-4 w-4 mr-2 text-[#DA251D]" />
                                            <span className="text-gray-300">
                                                123 Đường Trần Phú, Phường Móng Cái 1, TP Móng Cái, Quảng Ninh
                                            </span>
                                        </div>
                                        <div className="flex items-center">
                                            <Phone className="h-4 w-4 mr-2 text-[#DA251D]" />
                                            <span className="text-gray-300">(033) 123-4567</span>
                                        </div>
                                        <div className="flex items-center">
                                            <Mail className="h-4 w-4 mr-2 text-[#DA251D]" />
                                            <span className="text-gray-300">info@mongcai1.gov.vn</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div>
                                    <h4 className="font-bold mb-4">Liên kết chính thức</h4>
                                    <div className="space-y-2 text-sm">
                                        <a
                                            href="#"
                                            className="flex items-center text-gray-300 hover:text-white transition duration-200"
                                        >
                                            <ExternalLink className="h-4 w-4 mr-2" />
                                            Cổng thông tin Quảng Ninh
                                        </a>
                                        <a
                                            href="#"
                                            className="flex items-center text-gray-300 hover:text-white transition duration-200"
                                        >
                                            <ExternalLink className="h-4 w-4 mr-2" />
                                            UBND TP Móng Cái
                                        </a>
                                        <a
                                            href="#"
                                            className="flex items-center text-gray-300 hover:text-white transition duration-200"
                                        >
                                            <ExternalLink className="h-4 w-4 mr-2" />
                                            Cổng dịch vụ công quốc gia
                                        </a>
                                    </div>
                                </div>
                            </div>
                            
                            <div className="border-t border-gray-700 mt-8 pt-8 text-center">
                                <p className="text-gray-400 text-sm">
                                    © 2026 Thanh niên số Móng Cái 1. Tất cả quyền được bảo lưu.
                                </p>
                            </div>
                        </div>
                    </footer>
                </div>
            );
        };

        // Render the app
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<MongCaiPortal />);
    </script>
</body>
</html>